---
title: "music"
output: md_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(ggimage)
library(cowplot)

source("../R/themes.R")
knitr::opts_chunk$set(echo = TRUE, fig.path = "../figures/favegenes/")

```

## R Markdown



```{r respect}
song <- c("What", "you", "want,", "ba-", "by", "I", "got.")
stage <- c( "bldg", "lay", "inc.d9", "inc.d17", "hatch", "n5", "n9")
time <- c(1,2,3,4,5,6,7)
position <- c(1,2,3,4,5,6,7)
gene1 <- c(11,9,7,8,8,8,6)
gene2 <- c(7, 9,5,6,8,8,4)
gene3 <- c(4, 9,2,4,8,8,1)

respect <- as.data.frame(t(rbind(position, gene1,gene2,gene3)))
respect$song <- song
respect$stage <- stage
respect$image <- sample(c("https://cdn.pixabay.com/photo/2016/03/23/20/49/music-note-1275650_960_720.png"), 
                        size=7, replace = TRUE)
respect <- respect %>%
  pivot_longer(gene1:gene3, names_to = "music", values_to = "genes")  %>% 
  mutate(songstage = paste(song,stage, sep = "\n\n"))

songstageslim <- unique(respect$songstage)

respectsong <- ggplot(respect, aes(x = position, y = genes)) +
  geom_line(aes(color = music)) +
  geom_image(aes(image=image), size = 0.15) +
  scale_x_continuous(breaks = position,
                     labels = songstageslim,
                     name = element_blank()) +
  scale_y_continuous(breaks = c(3, 5, 7, 9),
                     labels = c( "F",   "A",   "C",  "E"),
                     limits = c(-1,12)) +
  geom_hline(yintercept=c(2.15,4.15,6.15,8.15,10.15))   +
  theme_B3() +
  theme(axis.ticks = element_blank()) +
  labs(subtitle = "RESPECT by Otis Redding, Jr.", y = NULL)
respectsong
```



```{r feelinggood}
song <- c("Birds", "fly-", "ing", "high,", "you", "know", "how", "I", "feel.")
stage <- charlevels
position <- c(1,2,3,4,5,6,7,8,9)
gene1 <- c(-2,0,1,2,2,1,1,-2,0)
gene2 <- gene1 - 1
gene1 <- gene2
gene3 <- gene2

feelinggood <- as.data.frame(t(rbind(position, gene1,gene2,gene3)))
feelinggood$song <- song
feelinggood$stage <- stage
feelinggood$image <- sample(c("https://cdn.pixabay.com/photo/2016/03/23/20/49/music-note-1275650_960_720.png"), 
                        size=9, replace = TRUE)
feelinggood <- feelinggood %>%
  pivot_longer(gene1:gene3, names_to = "music", values_to = "genes")   %>%
  mutate(songstage = paste(song,stage, sep = "\n\n"))
feelinggood

songstageslim <- unique(feelinggood$songstage)

feelinggoodsong <- ggplot(feelinggood, aes(x = position, y = genes)) +
  geom_line(aes(color = music)) +
  geom_image(aes(image=image), size = 0.15) +
  scale_x_continuous(breaks = position,
                    labels = songstageslim,
                     name = element_blank()) +
  scale_y_continuous(breaks = c(3, 5, 7, 9),
                     labels = c( "F",   "A",   "C",  "E"),
                     limits = c(-6,12)) +
  geom_hline(yintercept=c(2.15,4.15,6.15,8.15,10.15))   +
  theme_B3() +
  theme(axis.ticks = element_blank()) +
  labs(subtitle = "Feeling Good by L. Bricusse & A. Newley", y = NULL)
feelinggoodsong

```

```{r sinnerman}
song <- c("Oh,", "sin-", "ner", "man,,", "where", "_", "he", "gon'", "run", "_", "to?")
stage <- c( "bldg", "lay", "inc.d3", "m.inc.d3" ,
            "inc.d9", "m.inc.d9"  , 
            "inc.d17", "m.inc.d17" ,
            "hatch", "m.n2" ,
            "n5")
position <- c(1,2,3,4,5,6,7,8,9,10,11)
gene1 <- c(0,0,0,0,2,2,1,0,0,0,0)
gene2 <- gene1 + 2
gene3 <- gene2 + 2

sinnerman <- as.data.frame(t(rbind(position, gene1,gene2,gene3)))
sinnerman$song <- song
sinnerman$stage <- stage
sinnerman$image <- sample(c("https://cdn.pixabay.com/photo/2016/03/23/20/49/music-note-1275650_960_720.png"), 
                        size=11, replace = TRUE)
sinnerman <- sinnerman %>%
  pivot_longer(gene1:gene3, names_to = "music", values_to = "genes")   %>%
  mutate(songstage = paste(song,stage, sep = "\n\n"))
sinnerman

songstageslim <- unique(sinnerman$songstage)

sinnermansong <- ggplot(sinnerman, aes(x = position, y = genes)) +
  geom_line(aes(color = music)) +
  geom_image(aes(image=image), size = 0.1) +
  scale_x_continuous(breaks = position,
                    labels = songstageslim,
                     name = element_blank()) +
  scale_y_continuous(breaks = c(3, 5, 7, 9),
                     labels = c( "F",   "A",   "C",  "E"),
                     limits = c(-1,12)) +
  geom_hline(yintercept=c(2.15,4.15,6.15,8.15,10.15))   +
  theme_B3() +
  theme(axis.ticks = element_blank()) +
  labs(subtitle = "Sinnerman by Nina Simone", y = NULL)
sinnermansong


```
```{r soulmusic}
p1 <- plot_grid(respectsong + theme(legend.position = "none"), feelinggoodsong + theme(legend.position = "none"), rel_widths = c(0.45,0.55))

p3 <- plot_grid(p1, sinnermansong, nrow = 2)
p3
```

