---
title: "Fig3"
output: md_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Plots with Prolactin

```{r}
library(tidyverse)
library(cowplot)
library(magick)
library(png)
library(grid)
library(ggimage)
library(apaTables)

source("../R/themes.R") 
source("../R/functions.R")
source("../R/icons.R")

knitr::opts_chunk$set(fig.path = '../figures/',message=F, warning=FALSE)
```

## Circulating levels of prolactin and prolactin expression

```{r data}
prolactin <- read_csv("../results/07_hormones.csv") %>%
    filter(study == "characterization", hormone %in% c("prolactin"))  %>% 
    droplevels() 
prolactin$treatment <- factor(prolactin$treatment, levels = alllevels)


```



```{r fig3, fig.width=7}


a <- plotprolactin(PRLhyp, PRLhyp$counts, "PRL", "hypothalamus") + 
  theme(legend.position = "none", axis.text.x = element_blank(), axis.title.x = element_blank(),
        axis.title.y = element_text(face = "italic"))
b <- plotprolactin(PRLpit, PRLpit$counts, "PRL", "pituitary") + 
  theme(legend.position = "none", axis.text.x = element_blank(), axis.title.x = element_blank(),
        axis.title.y = element_text(face = "italic"))
c <- plotprolactin(prolactin, prolactin$plasma_conc, "prolactin (ng/mL)", "blood") +
  theme(legend.position = "none", axis.text.x = element_text(angle = 45, hjust = 1)) 
d <- plotprolactin(PRLgon, PRLgon$counts, "PRL", "gonads") + 
  theme(legend.position = "none", axis.text.x = element_text(angle = 45, hjust = 1),
        axis.title.y = element_text(face = "italic"))

mylegend <- plotprolactin(PRLvsd, PRLvsd$counts, "PRL", "gonads") +
  theme(legend.position = "bottom",
        legend.direction = "vertical",
        legend.key.size = unit(0.5, 'lines')) +
  guides(color = guide_legend(ncol = 1),
         shape = guide_legend(ncol = 1))
mylegend <- get_legend(mylegend)

allPLRplots <- plot_grid(a,b,c,d, labels = "auto", rel_heights = c(0.425,0.575))

fig3 <- plot_grid(allPLRplots, mylegend , nrow = 2, rel_heights = c(1,0.2))
fig3
```



