---
title: "candidate genes"
output: md_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(cowplot)

source("../R/functions.R")  # load custom functions 
source("../R/themes.R")  # load custom themes and color palletes


knitr::opts_chunk$set(echo = TRUE, fig.path = '../figures/specificgenes/')
```

# analyses downstream of calculating tissue specific variance in gene expression

```{r getvsdandcolData}
vsd.hyp <- readvsd("../results/04_vsd_hyp.csv")
colData.hyp <- readcolData("../results/04_colData_hyp.csv")

head(vsd.hyp[1:2])
head(colData.hyp[1:2,])
rownames(colData.hyp) == colnames(vsd.hyp)

vsd.pit <- readvsd("../results/04_vsd_pit.csv")
colData.pit <- readcolData("../results/04_colData_pit.csv")

vsd.gon <- readvsd("../results/04_vsd_gon.csv")
colData.gon <- readcolData("../results/04_colData_gon.csv")

```


# selecting candidate genes counts from the hypothalamus



```{r PRL}
geneinfo <- read_csv("../metadata/00_geneinfo.csv") %>%  dplyr::select(Name, geneid, entrezid) %>% arrange(Name)
head(geneinfo)
```

```{r PRLboxplots, fig.width =5.5, fig.height= 2}
candidategenes <- c("CISH", "SOCS1", "SOCS2", "SOCS2", "SOCS4", "SOCS5", "SOCS6", 
                    "PRL", "PRLR", "STAT5B", "JAK1")
candidates.hyp <- selectcandidatevsds(candidategenes, vsd.hyp, colData.hyp)
candidates.pit <- selectcandidatevsds(candidategenes, vsd.pit, colData.pit)
candidates.gon <- selectcandidatevsds(candidategenes, vsd.gon, colData.gon)

plotcanddateexpression <- function(candidateexpression,  mysubtitle, whichgene, myylab){
  
  ggplot(candidateexpression, aes(x = as.numeric(treatment), y = whichgene)) + 
        geom_smooth(aes(colour = sex)) +
    geom_boxplot(aes(fill = treatment, alpha = sex)) + 
    scale_alpha_manual(values = c(0.75,1)) +
     theme_B3() +
    theme(legend.position = "none") +
    theme(axis.title.y=element_text(face="italic"),
          axis.title.x = element_blank(),
          axis.text.x = element_blank()) +
    scale_color_manual(values = c("female" = "#969696", "male" = "#525252")) +
    labs(subtitle = mysubtitle, y = myylab)
  
}

a <- plotcanddateexpression(candidates.hyp,  "hypothalamus", candidates.hyp$PRL, "PRL")
b <- plotcanddateexpression(candidates.pit, "pituitary", candidates.pit$PRL, "PRL")
c <- plotcanddateexpression(candidates.gon,  "gonad", candidates.gon$PRL, "PRL")

plot_grid(a, b + labs(y = NULL), c + labs(y = NULL), nrow = 1)

e <- plotcanddateexpression(candidates.hyp, NULL, candidates.hyp$PRLR, "PRLR")
f <- plotcanddateexpression(candidates.pit, NULL, candidates.pit$PRLR, "PRLR")
g <- plotcanddateexpression(candidates.gon, NULL, candidates.gon$PRLR, "PRLR")

plot_grid(e, f + labs(y = NULL), g + labs(y = NULL), nrow = 1)


h <- plotcanddateexpression(candidates.hyp, " ", candidates.hyp$STAT5B, "STAT5B")
i <- plotcanddateexpression(candidates.pit, " ", candidates.pit$STAT5B, "STAT5B")
j <- plotcanddateexpression(candidates.gon, " ", candidates.gon$STAT5B, "STAT5B")

plot_grid(h, i + labs(y = NULL), j + labs(y = NULL), nrow = 1)
```


```{r PRLboxplots2, fig.width = 2.25, fig.height= 4}
plot_grid(a,b,c, nrow = 3)
```

```{r PRLdf}
head(candidates.pit)
PRLpit <- candidates.pit %>%
  select(sample,sex,treatment,PRL)
head(PRLpit)
write.csv(PRLpit, "../results/10_PRLpit.csv", row.names = F)
```

