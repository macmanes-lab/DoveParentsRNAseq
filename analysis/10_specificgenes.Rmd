---
title: "candidate genes"
output: md_document
---

# selecting candidate genes counts from the hypothalamus

```{r setup, include=FALSE}
library(tidyverse)
library(corrplot)

knitr::opts_chunk$set(echo = TRUE, fig.path = '../figures/specificgenes/')
```

```{r PRL}
# import "colData" which contains sample information and "countData" which contains read counts
c.colData <- read.csv("../metadata/00_colData_characterization.csv", header = T, row.names = 1)
c.countData <- read.csv("../results/00_countData_characterization.csv", header = T, row.names = 1)
geneinfo <- read_csv("../metadata/00_geneinfo.csv") %>% select(Name, entrezid)

# select only hypothalamus samples
hypsamples <- c.colData %>% 
  filter(tissue == "hypothalamus") %>%
  select(-study) %>%
  droplevels()
colnames(hypsamples)[colnames(hypsamples)=="treatment"] <- "timepoint"

countstokeep <- as.character(hypsamples$V1)
hypcounts <- c.countData %>% 
  mutate(entrezid = row.names(c.countData)) %>% 
  select(entrezid, countstokeep)

hypcounts <- left_join(geneinfo,hypcounts)

# select genes to keep 
# CISH, SOCS1, SOCS2, SOCS2, SOCS4, SOCS5, SOCS6
# PRL PRLR BRAC1

candidates <- c("CISH", "SOCS1", "SOCS2", "SOCS2", "SOCS4", "SOCS5", "SOCS6", "PRL", "PRLR")
hypcounts <- hypcounts %>% filter(Name %in% candidates)

# transform and combine into 1 dataframe
hypcounts <- as.data.frame(hypcounts)

row.names(hypcounts) <- hypcounts$Name
hypcounts$Name <- NULL
hypcounts$entrezid <- NULL
hypcandidatecounts <- as.data.frame(t(hypcounts))
hypcandidatecounts$V1 <- row.names(hypcandidatecounts)
hypcandidatecounts <- left_join(hypsamples, hypcandidatecounts)

# set rownames
row.names(hypcandidatecounts) <- hypcandidatecounts$V1
hypcandidatecounts$V1 <- NULL

# preview and write
head(hypcandidatecounts)
write.csv(hypcandidatecounts, "../results/10_hypcandidatecounts.csv")

# correlation matrix
forcorr <- hypcandidatecounts %>% 
  mutate(gene = row.names(hypcandidatecounts)) %>%  select(candidates)
M <- cor(forcorr)
M <- as.data.frame(M)
M$rownames <- row.names(M)
# M <- M %>% filter(totalentr > 0.7 | totalentr < -0.7)
row.names(M) <- M$rownames
greatthan05 <- M$rownames
M <- M %>% select(greatthan05)
M <- as.matrix(M)
corrplot.mixed(M, order = "hclust")

ggplot(hypcandidatecounts, aes(x = PRL, y = SOCS4, color = timepoint)) + 
  geom_point() + labs(subtitle = "PRL and SOCS5") + facet_wrap(~sex)

ggplot(hypcandidatecounts, aes(x = SOCS5, y = SOCS6, color = timepoint)) + 
  geom_point() + labs(subtitle = "SOCS5 and SOCS6") + facet_wrap(~sex)
```

