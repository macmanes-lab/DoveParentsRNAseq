---
title: "Fig2"
output: md_document
---


## this file no longer works! 

The code here is incomplete. Saving it to use for creating tables.


```{r setup, include=FALSE}

source("../R/themes.R")

knitr::opts_chunk$set(echo = TRUE, message = F, fig.path = "../figures/")
```


```{r fig2, fig.width=7, fig.height=7}


```


## total degs

```{r}
allDEG %>%
  group_by(sex, tissue, comparison) %>%
  summarize(totalDEGs = n()) %>%
  arrange(tissue, comparison)
```

## candidate genes 
```{r writefiles}
geneids <- read_csv("../metadata/00_geneinfo.csv")

candidategenesslim <- c("OXT", "AVP", "GNRH1", "GNRHR", 
                    "AR",  "CYP19A1", 
                     "AVPR1A", "AVPR1B", "AVPR2","VIP",
                  "DRD1", "DRD2", 
                  "PRL", "PRLR",  
                    "ESR1","ESR2", "LBH",  
                   
                    "FOS", "JUN", "EGR1", "BDNF"
                      ) 

table1 <- allDEG %>%
  mutate(updown = ifelse(lfc > 0, "+", "-"))  %>%
  mutate(geneupdown = paste(gene, updown, sep = "")) %>%
  filter(gene %in% candidategenes) %>%
  arrange(geneupdown) %>%
  group_by(sex, tissue, comparison) %>%
  summarize(genes = str_c(geneupdown, collapse = " ")) %>%
  pivot_wider(names_from = comparison, values_from = genes ) %>%
  select(sex, tissue, control_bldg, bldg_lay, lay_inc.d3, inc.d3_inc.d9,
        inc.d9_inc.d17, hatch_n5)  %>%
  arrange( tissue, sex)
kable(table1)

write_csv(table1, "../results/table1.csv")
```

## supplemental tables, all DEGS

```{r}


suppletable1 <- allDEG %>%
  filter(comparison != "control_bldg") %>%
  group_by(sex, tissue, comparison) %>%
  arrange( tissue, sex, direction, gene)
head(suppletable1)

suppletable1 %>%
  group_by(tissue) %>%
  summarize(totalDEGs = n())


write_csv(suppletable1, "../results/suppletable1.csv")


head(allDEG) 
```




```{r savefiles}
allDEG %>%
  drop_na()

#write.csv(allDEG, "../../musicalgenes/data/allDEG.csv")

```