---
title: "edgeR"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(edgeR)
library(org.Gg.eg.db)
```

# edgeR: differential expression analysis of digital gene expression data

https://www.bioconductor.org/packages/release/bioc/vignettes/edgeR/inst/doc/edgeRUsersGuide.pdf

## quick start

```{r}
x <- read.csv("../results/00_countData_characterization.csv", header = T, row.names = 1)
colData <- read.csv("../metadata/00_colData_characterization.csv", header = T, row.names = 1)
group <- colData$treatment

y <- DGEList(counts=x,group=group)
y <- calcNormFactors(y)
design <- model.matrix(~group)
y <- estimateDisp(y,design)

# To perform quasi-likelihood F-tests:
fit <- glmQLFit(y,design)
qlf <- glmQLFTest(fit,coef=2)
topqlf <- as.data.frame(topTags(qlf))

topqlf$entrezid <- row.names(topqlf)
left_join(topqlf, geneinfo, by = "entrezid")
```
