---
title: "favgenes"
output: md_document
---

```{r setup, include=FALSE}
library(tidyverse)
source("../R/themes.R") 

knitr::opts_chunk$set(echo = TRUE)

knitr::opts_chunk$set(echo = TRUE, fig.path = '../figures/favegenes/', cache = T)
```

```{r pseudocounts}
pseudocounts <- read_csv("../results/01_pseudo.counts.csv")
head(pseudocounts[1:3])

geneinfo <- read.csv("../metadata/00_geneinfo.csv", row.names = 1)
head(geneinfo)

# prep col data for all samples
colData <- read.csv("../metadata/00_samples.csv", header = T, row.names = 1)
colData$treatment <- factor(colData$treatment, levels = alllevels)
colData <- colData %>% mutate(tissue = fct_recode(tissue, "gonads" = "gonad"))
colData$tissue <- factor(colData$tissue, levels = tissuelevels)
row.names(colData) <- colData$V1


# prep count data for all samples
countData <- as.data.frame(pseudocounts)
countData$entrezid <- countData$X1
countData <- left_join(geneinfo, countData)
countData <- countData %>% dplyr::distinct(Name, .keep_all = TRUE) %>%
    dplyr::select(-row.names, -geneid, -entrezid, -X1) 
countData <- as.data.frame(countData)
row.names(countData) <- countData$Name
countData$Name <- NULL
countData$entrezid <- NULL
countData <- as.data.frame(t(countData))


# keep names for 
favcounts <- countData %>% dplyr::select("PRL", "COX1", "GH", "CHGA", 
                                         "FOS", "EGR1", "GNRHR", "GNRH1")
# check okay to bind rather than join
row.names(countData) == row.names(colData)
favcounts <- cbind(colData, favcounts)

ggplot(favcounts, aes(x = treatment, y = PRL, fill = treatment, color = sex)) +
  geom_boxplot() + 
  mytheme() +
    scale_fill_manual(values = colorscharmaip) +
    scale_color_manual(values = sexcolors) +
      theme(axis.text.x = element_text(angle = 45, hjust = 1),
          legend.position = "none",
          strip.text = element_blank()) 

ggplot(favcounts, aes(x = treatment, y = GH, fill = treatment, color = sex)) +
  geom_boxplot() + 
  mytheme() +
    scale_fill_manual(values = colorscharmaip) +
    scale_color_manual(values = sexcolors) +
      theme(axis.text.x = element_text(angle = 45, hjust = 1),
          legend.position = "none",
          strip.text = element_blank()) 
```

